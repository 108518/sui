extends base

block title
  title Label 

block sidebar
  +sidebar('ac')

block content

  h1 自动补全

  h2.sui-page-header 开发者文档

  p.sui-lead
    | 自动补全，支持本地数据和ajax异步加载数据。

  ul.sui-nav.nav-tabs.nav-large
    li.active
      a(href='#demo1', data-toggle='tab') 示例
    li
      a(href='#code1', data-toggle='tab') 代码
    li
      a(href='#doc1', data-toggle='tab') 文档

  div.tab-content
    div.tab-pane.active#demo1
      h4 使用本地数据
      form.sui-form
        input#input1.input-xlarge(type='text' placeholder='输入...')
        .help-inline#help1

      script(src='assets/js/countries.js')
      script.
        $(function() {
          $('#input1').autocomplete({
            lookup: countries,
            onSelect: function (suggestion) {
              $("#help1").html('您选择了'+suggestion.value);
            }
          });
        });
      h4 使用ajax获取数据
      form.sui-form
        input#input2.input-xlarge(type='text' placeholder='输入...')
        .help-inline#help2

      script(src='assets/js/jquery.mockjax.js')
      script.
        var countriesArray = $.map(countries, function (value, key) { return { value: value, data: key }; });
        // Setup jQuery ajax mock:
        $.mockjax({
            url: '*',
            responseTime: 0,
            response: function (settings) {
                var query = settings.data.query,
                    queryLowerCase = query.toLowerCase(),
                    re = new RegExp('\\b' + $.Autocomplete.utils.escapeRegExChars(queryLowerCase), 'gi'),
                    suggestions = $.grep(countriesArray, function (country) {
                         // return country.value.toLowerCase().indexOf(queryLowerCase) === 0;
                        return re.test(country.value);
                    }),
                    response = {
                        query: query,
                        suggestions: suggestions
                    };

                this.responseText = JSON.stringify(response);
            }
        });
        $(function() {
          $('#input2').autocomplete({
            serviceUrl: 'dada',
            onSelect: function (suggestion) {
              $("#help2").html('您选择了'+suggestion.value);
            }
          });
        });

    div.tab-pane#code1
      pre.prettyprint.linenums(data-target='#demo1')
    div.tab-pane#doc1
      p.sui-lead
        | 调用 <code>autocomplete</code> 可以传入一个参数对象，所有配置项如下表所示。所有json类型的配置项同时也支持以data-api的形式来配置。
      table.sui-table
        thead
          tr
            th 参数
            th 默认值
            th 说明
        tbody
          tr
            td autoSelectFirst
            td false
            td 是否自动选中第一个
          tr
            td appendTo
            td "body"
            td 自动补全的菜单的容器
          tr
            td serviceUrl
            td null
            td 获取数据的接口，如果定义了lookup 则此配置无效
          tr
            td lookup
            td null
            td 读取本地数据，比如 ['a', 'b', 'c']，如果配置了lookup，则忽略serviceUrl

          tr
            td onSelect
            td null
            td 选中结果时的回调,参数 (element, suggestion)

          tr
            td params
            td {}
            td 附加参数

          tr
            td formatResult
            td Autocomplete.formatResult
            td 格式化补全结果，参数(suggestion, currentValue)
  ul.demo-operations.clearfix
    li
      a.copy-btn(href='javascript:void(0)', data-target='#demo1>div') 复制代码
  
  h2 通过HTML标记自动初始化
  p.sui-lead
    | 在input上添加 <code>data-toggle='autocomplete'</code> 可以启用自动补全，并且所有js中json类型的配置的参数都可以通过 data-api 在html中直接配置
  ul.sui-nav.nav-tabs.nav-large
    li.active
      a(href='#demo3', data-toggle='tab') 示例
    li
      a(href='#code3', data-toggle='tab') 代码

  div.tab-content
    div.tab-pane.active#demo3
      form.sui-form
        h4 通过ajax读取数据
        input.input-large(type="text" id='auto-init-1' value='' data-toggle='autocomplete' data-serviceUrl='/ac.json')
        h4 使用本地数据
        input.input-large(type="text" id='auto-init-2' value='' data-toggle='autocomplete' data-lookup='["aaa", "bbb", "ccc", "ddd", "edfa", "wdasda", "tueiyhgk", "vjflcjx"]')
    div.tab-pane#code3
      pre.prettyprint.linenums(data-target='#demo3')
  ul.demo-operations.clearfix
    li
      a.copy-btn(href='javascript:void(0)', data-target='#demo3>div') 复制代码
  
  h2 模拟下拉菜单样式
  p.sui-lead
    | 这里的结构比dropdown简单很多，只是样式上比较像。
  ul.sui-nav.nav-tabs.nav-large
    li.active
      a(href='#demo2', data-toggle='tab') 示例
    li
      a(href='#code2', data-toggle='tab') 代码

  div.tab-content
    div.tab-pane.active#demo2
      form.sui-form
        span.sui-dropdown-like
          i.caret
          input.input-large(type="text" id='dropdown-input' value='')

      script.
        $(function() {
          $('#dropdown-input').autocomplete({
            lookup: countries
          });
        });
    div.tab-pane#code2
      pre.prettyprint.linenums(data-target='#demo2')
  ul.demo-operations.clearfix
    li
      a.copy-btn(href='javascript:void(0)', data-target='#demo2>div') 复制代码
